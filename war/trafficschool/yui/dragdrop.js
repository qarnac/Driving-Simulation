/*
	Copyright (c) 2004-2009, The Dojo Foundation All Rights Reserved.
	Available via Academic Free License >= 2.1 OR the modified BSD license.
	see: http://dojotoolkit.org/license for details
*/


YAHOO.util.DragDrop=function(id,_2,_3){if(id){this.init(id,_2,_3);}};YAHOO.util.DragDrop.prototype={id:null,config:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){this.logger.log("onAvailable (base)");},getEl:function(){if(!this._domRef){this._domRef=YAHOO.util.Dom.get(this.id);}return this._domRef;},getDragEl:function(){return YAHOO.util.Dom.get(this.dragElId);},init:function(id,_1b,_1c){this.initTarget(id,_1b,_1c);YAHOO.util.Event.addListener(this.id,"mousedown",this.handleMouseDown,this,true);},initTarget:function(id,_1e,_1f){this.config=_1f||{};this.DDM=YAHOO.util.DDM;this.groups={};this.id=id;this.addToGroup((_1e)?_1e:"default");this.handleElId=id;YAHOO.util.Event.onAvailable(id,this.handleOnAvailable,this,true);this.logger=(YAHOO.widget.LogWriter)?new YAHOO.widget.LogWriter(this.toString()):YAHOO;this.setDragElId(id);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.applyConfig();},applyConfig:function(){this.padding=this.config.padding||[0,0,0,0];this.isTarget=(this.config.isTarget!==false);this.maintainOffset=(this.config.maintainOffset);this.primaryButtonOnly=(this.config.primaryButtonOnly!==false);},handleOnAvailable:function(){this.logger.log("handleOnAvailable");this.available=true;this.resetConstraints();this.onAvailable();},setPadding:function(_20,_21,_22,_23){if(!_21&&0!==_21){this.padding=[_20,_20,_20,_20];}else{if(!_22&&0!==_22){this.padding=[_20,_21,_20,_21];}else{this.padding=[_20,_21,_22,_23];}}},setInitPosition:function(_24,_25){var el=this.getEl();if(!this.DDM.verifyEl(el)){this.logger.log(this.id+" element is broken");return;}var dx=_24||0;var dy=_25||0;var p=YAHOO.util.Dom.getXY(el);this.initPageX=p[0]-dx;this.initPageY=p[1]-dy;this.lastPageX=p[0];this.lastPageY=p[1];this.logger.log(this.id+" inital position: "+this.initPageX+", "+this.initPageY);this.setStartPosition(p);},setStartPosition:function(pos){var p=pos||YAHOO.util.Dom.getXY(this.getEl());this.deltaSetXY=null;this.startPageX=p[0];this.startPageY=p[1];},addToGroup:function(_2c){this.groups[_2c]=true;this.DDM.regDragDrop(this,_2c);},removeFromGroup:function(_2d){this.logger.log("Removing from group: "+_2d);if(this.groups[_2d]){delete this.groups[_2d];}this.DDM.removeDDFromGroup(this,_2d);},setDragElId:function(id){this.dragElId=id;},setHandleElId:function(id){this.handleElId=id;this.DDM.regHandle(this.id,id);},setOuterHandleElId:function(id){this.logger.log("Adding outer handle event: "+id);YAHOO.util.Event.addListener(id,"mousedown",this.handleMouseDown,this,true);this.setHandleElId(id);},unreg:function(){this.logger.log("DragDrop obj cleanup "+this.id);YAHOO.util.Event.removeListener(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this);},isLocked:function(){return (this.DDM.isLocked()||this.locked);},handleMouseDown:function(e,oDD){this.logger.log("isLocked: "+this.isLocked());var EU=YAHOO.util.Event;var _34=e.which||e.button;this.logger.log("button: "+_34);if(this.primaryButtonOnly&&_34>1){this.logger.log("Mousedown was not produced by the primary button");return;}if(this.isLocked()){this.logger.log("Drag and drop is disabled, aborting");return;}this.logger.log("mousedown "+this.id);this.DDM.refreshCache(this.groups);var pt=new YAHOO.util.Point(EU.getPageX(e),EU.getPageY(e));if(this.DDM.isOverTarget(pt,this)){this.logger.log("click is over target");var _36=EU.getTarget(e);if(this.isValidHandleChild(_36)&&(this.id==this.handleElId||this.DDM.handleWasClicked(_36,this.id))){this.logger.log("click was a valid handle");this.setStartPosition();this.logger.log("firing onMouseDown events");this.b4MouseDown(e);this.onMouseDown(e);this.DDM.handleMouseDown(e,this);this.DDM.stopEvent(e);}}},addInvalidHandleType:function(_37){var _38=_37.toUpperCase();this.invalidHandleTypes[_38]=_38;},addInvalidHandleId:function(id){this.invalidHandleIds[id]=id;},addInvalidHandleClass:function(_3a){this.invalidHandleClasses.push(_3a);},removeInvalidHandleType:function(_3b){var _3c=_3b.toUpperCase();delete this.invalidHandleTypes[_3c];},removeInvalidHandleId:function(id){delete this.invalidHandleIds[id];},removeInvalidHandleClass:function(_3e){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i){if(this.invalidHandleClasses[i]==_3e){delete this.invalidHandleClasses[i];}}},isValidHandleChild:function(_41){var _42=true;var _43;try{_43=_41.nodeName.toUpperCase();}catch(e){_43=_41.nodeName;}_42=_42&&!this.invalidHandleTypes[_43];_42=_42&&!this.invalidHandleIds[_41.id];for(var i=0,len=this.invalidHandleClasses.length;_42&&i<len;++i){_42=!YAHOO.util.Dom.hasClass(_41,this.invalidHandleClasses[i]);}this.logger.log("Valid handle? ... "+_42);return _42;},setXTicks:function(_46,_47){this.xTicks=[];this.xTickSize=_47;var _48={};for(var i=this.initPageX;i>=this.minX;i=i-_47){if(!_48[i]){this.xTicks[this.xTicks.length]=i;_48[i]=true;}}for(i=this.initPageX;i<=this.maxX;i=i+_47){if(!_48[i]){this.xTicks[this.xTicks.length]=i;_48[i]=true;}}this.xTicks.sort(this.DDM.numericSort);this.logger.log("xTicks: "+this.xTicks.join());},setYTicks:function(_4a,_4b){this.yTicks=[];this.yTickSize=_4b;var _4c={};for(var i=this.initPageY;i>=this.minY;i=i-_4b){if(!_4c[i]){this.yTicks[this.yTicks.length]=i;_4c[i]=true;}}for(i=this.initPageY;i<=this.maxY;i=i+_4b){if(!_4c[i]){this.yTicks[this.yTicks.length]=i;_4c[i]=true;}}this.yTicks.sort(this.DDM.numericSort);this.logger.log("yTicks: "+this.yTicks.join());},setXConstraint:function(_4e,_4f,_50){this.leftConstraint=_4e;this.rightConstraint=_4f;this.minX=this.initPageX-_4e;this.maxX=this.initPageX+_4f;if(_50){this.setXTicks(this.initPageX,_50);}this.constrainX=true;this.logger.log("initPageX:"+this.initPageX+" minX:"+this.minX+" maxX:"+this.maxX);},clearConstraints:function(){this.logger.log("Clearing constraints");this.constrainX=false;this.constrainY=false;this.clearTicks();},clearTicks:function(){this.logger.log("Clearing ticks");this.xTicks=null;this.yTicks=null;this.xTickSize=0;this.yTickSize=0;},setYConstraint:function(iUp,_52,_53){this.logger.log("setYConstraint: "+iUp+","+_52+","+_53);this.topConstraint=iUp;this.bottomConstraint=_52;this.minY=this.initPageY-iUp;this.maxY=this.initPageY+_52;if(_53){this.setYTicks(this.initPageY,_53);}this.constrainY=true;this.logger.log("initPageY:"+this.initPageY+" minY:"+this.minY+" maxY:"+this.maxY);},resetConstraints:function(){this.logger.log("resetConstraints");if(this.initPageX||this.initPageX===0){this.logger.log("init pagexy: "+this.initPageX+", "+this.initPageY);this.logger.log("last pagexy: "+this.lastPageX+", "+this.lastPageY);var dx=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var dy=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy);}else{this.setInitPosition();}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize);}},getTick:function(val,_57){if(!_57){return val;}else{if(_57[0]>=val){return _57[0];}else{for(var i=0,len=_57.length;i<len;++i){var _5a=i+1;if(_57[_5a]&&_57[_5a]>=val){var _5b=val-_57[i];var _5c=_57[_5a]-val;return (_5c>_5b)?_57[i]:_57[_5a];}}return _57[_57.length-1];}}},toString:function(){return ("DragDrop "+this.id);}};if(!YAHOO.util.DragDropMgr){YAHOO.util.DragDropMgr=new function(){this.ids={};this.handleIds={};this.dragCurrent=null;this.dragOvers={};this.logger=null;this.deltaX=0;this.deltaY=0;this.preventDefault=true;this.stopPropagation=true;this.initalized=false;this.locked=false;this.init=function(){this.logger=(YAHOO.widget.LogWriter)?new YAHOO.widget.LogWriter("DragDropMgr"):YAHOO;this.initialized=true;};this.POINT=0;this.INTERSECT=1;this.mode=this.POINT;this._execOnAll=function(_5d,_5e){for(var i in this.ids){for(var j in this.ids[i]){var oDD=this.ids[i][j];if(!this.isTypeOfDD(oDD)){continue;}oDD[_5d].apply(oDD,_5e);}}};this._onLoad=function(){this.init();this.logger.log("DDM onload");var EU=YAHOO.util.Event;EU.on(document,"mouseup",this.handleMouseUp,this,true);EU.on(document,"mousemove",this.handleMouseMove,this,true);EU.on(window,"unload",this._onUnload,this,true);EU.on(window,"resize",this._onResize,this,true);};this._onResize=function(e){this.logger.log("window resize");this._execOnAll("resetConstraints",[]);};this.lock=function(){this.locked=true;};this.unlock=function(){this.locked=false;};this.isLocked=function(){return this.locked;};this.locationCache={};this.useCache=true;this.clickPixelThresh=3;this.clickTimeThresh=1000;this.dragThreshMet=false;this.clickTimeout=null;this.startX=0;this.startY=0;this.regDragDrop=function(oDD,_65){if(!this.initialized){this.init();}if(!this.ids[_65]){this.ids[_65]={};}this.ids[_65][oDD.id]=oDD;};this.removeDDFromGroup=function(oDD,_67){if(!this.ids[_67]){this.ids[_67]={};}var obj=this.ids[_67];if(obj&&obj[oDD.id]){delete obj[oDD.id];}};this._remove=function(oDD){for(var g in oDD.groups){if(g&&this.ids[g][oDD.id]){delete this.ids[g][oDD.id];}}delete this.handleIds[oDD.id];};this.regHandle=function(_6b,_6c){if(!this.handleIds[_6b]){this.handleIds[_6b]={};}this.handleIds[_6b][_6c]=_6c;};this.isDragDrop=function(id){return (this.getDDById(id))?true:false;};this.getRelated=function(_6e,_6f){var _70=[];for(var i in _6e.groups){for(j in this.ids[i]){var dd=this.ids[i][j];if(!this.isTypeOfDD(dd)){continue;}if(!_6f||dd.isTarget){_70[_70.length]=dd;}}}return _70;};this.isLegalTarget=function(oDD,_74){var _75=this.getRelated(oDD,true);for(var i=0,len=_75.length;i<len;++i){if(_75[i].id==_74.id){return true;}}return false;};this.isTypeOfDD=function(oDD){return (oDD&&oDD.__ygDragDrop);};this.isHandle=function(_79,_7a){return (this.handleIds[_79]&&this.handleIds[_79][_7a]);};this.getDDById=function(id){for(var i in this.ids){if(this.ids[i][id]){return this.ids[i][id];}}return null;};this.handleMouseDown=function(e,oDD){this.currentTarget=YAHOO.util.Event.getTarget(e);this.logger.log("mousedown - adding event handlers");this.dragCurrent=oDD;var el=oDD.getEl();this.startX=YAHOO.util.Event.getPageX(e);this.startY=YAHOO.util.Event.getPageY(e);this.deltaX=this.startX-el.offsetLeft;this.deltaY=this.startY-el.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var DDM=YAHOO.util.DDM;DDM.startDrag(DDM.startX,DDM.startY);},this.clickTimeThresh);};this.startDrag=function(x,y){this.logger.log("firing drag start events");clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(x,y);this.dragCurrent.startDrag(x,y);}this.dragThreshMet=true;};this.handleMouseUp=function(e){if(!this.dragCurrent){return;}clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.logger.log("mouseup detected - completing drag");this.fireEvents(e,true);}else{this.logger.log("drag threshold not met");}this.stopDrag(e);this.stopEvent(e);};this.stopEvent=function(e){if(this.stopPropagation){YAHOO.util.Event.stopPropagation(e);}if(this.preventDefault){YAHOO.util.Event.preventDefault(e);}};this.stopDrag=function(e){if(this.dragCurrent){if(this.dragThreshMet){this.logger.log("firing endDrag events");this.dragCurrent.b4EndDrag(e);this.dragCurrent.endDrag(e);}this.logger.log("firing mouseUp event");this.dragCurrent.onMouseUp(e);}this.dragCurrent=null;this.dragOvers={};};this.handleMouseMove=function(e){if(!this.dragCurrent){return true;}if(YAHOO.util.Event.isIE&&!e.button){this.logger.log("button failure");this.stopEvent(e);return this.handleMouseUp(e);}if(!this.dragThreshMet){var _87=Math.abs(this.startX-YAHOO.util.Event.getPageX(e));var _88=Math.abs(this.startY-YAHOO.util.Event.getPageY(e));if(_87>this.clickPixelThresh||_88>this.clickPixelThresh){this.logger.log("pixel threshold met");this.startDrag(this.startX,this.startY);}}if(this.dragThreshMet){this.dragCurrent.b4Drag(e);this.dragCurrent.onDrag(e);this.fireEvents(e,false);}this.stopEvent(e);return true;};this.fireEvents=function(e,_8a){var dc=this.dragCurrent;if(!dc||dc.isLocked()){return;}var x=YAHOO.util.Event.getPageX(e);var y=YAHOO.util.Event.getPageY(e);var pt=new YAHOO.util.Point(x,y);var _8f=[];var _90=[];var _91=[];var _92=[];var _93=[];for(var i in this.dragOvers){var ddo=this.dragOvers[i];if(!this.isTypeOfDD(ddo)){continue;}if(!this.isOverTarget(pt,ddo,this.mode)){_90.push(ddo);}_8f[i]=true;delete this.dragOvers[i];}for(var _96 in dc.groups){if("string"!=typeof _96){continue;}for(i in this.ids[_96]){var oDD=this.ids[_96][i];if(!this.isTypeOfDD(oDD)){continue;}if(oDD.isTarget&&!oDD.isLocked()&&oDD!=dc){if(this.isOverTarget(pt,oDD,this.mode)){if(_8a){_92.push(oDD);}else{if(!_8f[oDD.id]){_93.push(oDD);}else{_91.push(oDD);}this.dragOvers[oDD.id]=oDD;}}}}}if(this.mode){if(_90.length){this.logger.log(dc.id+" onDragOut: "+_90);dc.b4DragOut(e,_90);dc.onDragOut(e,_90);}if(_93.length){this.logger.log(dc.id+" onDragEnter: "+_93);dc.onDragEnter(e,_93);}if(_91.length){this.logger.log(dc.id+" onDragOver: "+_91);dc.b4DragOver(e,_91);dc.onDragOver(e,_91);}if(_92.length){this.logger.log(dc.id+" onDragDrop: "+_92);dc.b4DragDrop(e,_92);dc.onDragDrop(e,_92);}}else{var len=0;for(i=0,len=_90.length;i<len;++i){this.logger.log(dc.id+" onDragOut: "+_90[i].id);dc.b4DragOut(e,_90[i].id);dc.onDragOut(e,_90[i].id);}for(i=0,len=_93.length;i<len;++i){this.logger.log(dc.id+" onDragEnter "+_93[i].id);dc.onDragEnter(e,_93[i].id);}for(i=0,len=_91.length;i<len;++i){this.logger.log(dc.id+" onDragOver "+_91[i].id);dc.b4DragOver(e,_91[i].id);dc.onDragOver(e,_91[i].id);}for(i=0,len=_92.length;i<len;++i){this.logger.log(dc.id+" dropped on "+_92[i].id);dc.b4DragDrop(e,_92[i].id);dc.onDragDrop(e,_92[i].id);}}};this.getBestMatch=function(dds){var _9a=null;var len=dds.length;if(len==1){_9a=dds[0];}else{for(var i=0;i<len;++i){var dd=dds[i];if(dd.cursorIsOver){_9a=dd;break;}else{if(!_9a||_9a.overlap.getArea()<dd.overlap.getArea()){_9a=dd;}}}}return _9a;};this.refreshCache=function(_9e){this.logger.log("refreshing element location cache");for(sGroup in _9e){if("string"!=typeof sGroup){continue;}for(i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(this.isTypeOfDD(oDD)){var loc=this.getLocation(oDD);if(loc){this.locationCache[oDD.id]=loc;}else{delete this.locationCache[oDD.id];this.logger.log("Could not get the loc for "+oDD.id,"warn");}}}}};this.verifyEl=function(el){try{if(el){var _a2=el.offsetParent;if(_a2){return true;}}}catch(e){this.logger.log("detected problem with an element");}return false;};this.getLocation=function(oDD){if(!this.isTypeOfDD(oDD)){this.logger.log(oDD+" is not a DD obj");return null;}var el=oDD.getEl();var _a5=null;try{_a5=YAHOO.util.Dom.getXY(el);}catch(e){}if(!_a5){return null;}x1=_a5[0];x2=x1+el.offsetWidth;y1=_a5[1];y2=y1+el.offsetHeight;var t=y1-oDD.padding[0];var r=x2+oDD.padding[1];var b=y2+oDD.padding[2];var l=x1-oDD.padding[3];return new YAHOO.util.Region(t,r,b,l);};this.isOverTarget=function(pt,_ab,_ac){var loc=this.locationCache[_ab.id];if(!loc||!this.useCache){this.logger.log("cache not populated");loc=this.getLocation(_ab);this.locationCache[_ab.id]=loc;this.logger.log("cache: "+loc);}if(!loc){return false;}_ab.cursorIsOver=loc.contains(pt);var dc=this.dragCurrent;if(!dc||!dc.getTargetCoord||(!_ac&&!dc.constrainX&&!dc.constrainY)){return _ab.cursorIsOver;}_ab.overlap=null;var pos=dc.getTargetCoord(pt.x,pt.y);var el=dc.getDragEl();var _b1=new YAHOO.util.Region(pos.y,pos.x+el.offsetWidth,pos.y+el.offsetHeight,pos.x);var _b2=_b1.intersect(loc);if(_b2){_ab.overlap=_b2;return (_ac)?true:_ab.cursorIsOver;}else{return false;}};this._onUnload=function(e,me){this.unregAll();};this.unregAll=function(){this.logger.log("unregister all");if(this.dragCurrent){this.stopDrag();this.dragCurrent=null;}this._execOnAll("unreg",[]);for(i in this.elementCache){delete this.elementCache[i];}this.elementCache={};this.ids={};};this.elementCache={};this.getElWrapper=function(id){var _b6=this.elementCache[id];if(!_b6||!_b6.el){_b6=this.elementCache[id]=new this.ElementWrapper(YAHOO.util.Dom.get(id));}return _b6;};this.getElement=function(id){return YAHOO.util.Dom.get(id);};this.getCss=function(id){var el=YAHOO.util.Dom.get(id);return (el)?el.style:null;};this.ElementWrapper=function(el){this.el=el||null;this.id=this.el&&el.id;this.css=this.el&&el.style;};this.getPosX=function(el){return YAHOO.util.Dom.getX(el);};this.getPosY=function(el){return YAHOO.util.Dom.getY(el);};this.swapNode=function(n1,n2){if(n1.swapNode){n1.swapNode(n2);}else{var p=n2.parentNode;var s=n2.nextSibling;n1.parentNode.replaceChild(n2,n1);p.insertBefore(n1,s);}};this.getScroll=function(){var t,l;if(document.documentElement&&document.documentElement.scrollTop){t=document.documentElement.scrollTop;l=document.documentElement.scrollLeft;}else{if(document.body){t=document.body.scrollTop;l=document.body.scrollLeft;}}return {top:t,left:l};};this.getStyle=function(el,_c4){return YAHOO.util.Dom.getStyle(el,_c4);};this.getScrollTop=function(){return this.getScroll().top;};this.getScrollLeft=function(){return this.getScroll().left;};this.moveToEl=function(_c5,_c6){var _c7=YAHOO.util.Dom.getXY(_c6);this.logger.log("moveToEl: "+_c7);YAHOO.util.Dom.setXY(_c5,_c7);};this.getClientHeight=function(){return YAHOO.util.Dom.getClientHeight();};this.getClientWidth=function(){return YAHOO.util.Dom.getClientWidth();};this.numericSort=function(a,b){return (a-b);};this._timeoutCount=0;this._addListeners=function(){if(YAHOO.util.Event&&document){this._onLoad();}else{if(this._timeoutCount>1000){this.logger.log("DragDrop requires the Event Utility");}else{var DDM=YAHOO.util.DDM;setTimeout(function(){DDM._addListeners();},10);if(document&&document.body){this._timeoutCount+=1;}}}};this.handleWasClicked=function(_cb,id){if(this.isHandle(id,_cb.id)){this.logger.log("clicked node is a handle");return true;}else{var p=_cb.parentNode;while(p){if(this.isHandle(id,p.id)){return true;}else{this.logger.log(p.id+" is not a handle");p=p.parentNode;}}}return false;};}();YAHOO.util.DDM=YAHOO.util.DragDropMgr;YAHOO.util.DDM._addListeners();}YAHOO.util.DD=function(id,_cf,_d0){if(id){this.init(id,_cf,_d0);}};YAHOO.extend(YAHOO.util.DD,YAHOO.util.DragDrop);YAHOO.util.DD.prototype.scroll=true;YAHOO.util.DD.prototype.autoOffset=function(_d1,_d2){var x=_d1-this.startPageX;var y=_d2-this.startPageY;this.setDelta(x,y);};YAHOO.util.DD.prototype.setDelta=function(_d5,_d6){this.deltaX=_d5;this.deltaY=_d6;this.logger.log("deltaX:"+this.deltaX+", deltaY:"+this.deltaY);};YAHOO.util.DD.prototype.setDragElPos=function(_d7,_d8){var el=this.getDragEl();this.alignElWithMouse(el,_d7,_d8);};YAHOO.util.DD.prototype.alignElWithMouse=function(el,_db,_dc){var _dd=this.getTargetCoord(_db,_dc);if(!this.deltaSetXY){var _de=[_dd.x,_dd.y];YAHOO.util.Dom.setXY(el,_de);var _df=parseInt(YAHOO.util.Dom.getStyle(el,"left"),10);var _e0=parseInt(YAHOO.util.Dom.getStyle(el,"top"),10);this.deltaSetXY=[_df-_dd.x,_e0-_dd.y];}else{YAHOO.util.Dom.setStyle(el,"left",(_dd.x+this.deltaSetXY[0])+"px");YAHOO.util.Dom.setStyle(el,"top",(_dd.y+this.deltaSetXY[1])+"px");}this.cachePosition(_dd.x,_dd.y);this.autoScroll(_dd.x,_dd.y,el.offsetHeight,el.offsetWidth);};YAHOO.util.DD.prototype.cachePosition=function(_e1,_e2){if(_e1){this.lastPageX=_e1;this.lastPageY=_e2;}else{var _e3=YAHOO.util.Dom.getXY(this.getEl());this.lastPageX=_e3[0];this.lastPageY=_e3[1];}};YAHOO.util.DD.prototype.autoScroll=function(x,y,h,w){if(this.scroll){var _e8=this.DDM.getClientHeight();var _e9=this.DDM.getClientWidth();var st=this.DDM.getScrollTop();var sl=this.DDM.getScrollLeft();var bot=h+y;var _ed=w+x;var _ee=(_e8+st-y-this.deltaY);var _ef=(_e9+sl-x-this.deltaX);var _f0=40;var _f1=(document.all)?80:30;if(bot>_e8&&_ee<_f0){window.scrollTo(sl,st+_f1);}if(y<st&&st>0&&y-st<_f0){window.scrollTo(sl,st-_f1);}if(_ed>_e9&&_ef<_f0){window.scrollTo(sl+_f1,st);}if(x<sl&&sl>0&&x-sl<_f0){window.scrollTo(sl-_f1,st);}}};YAHOO.util.DD.prototype.getTargetCoord=function(_f2,_f3){var x=_f2-this.deltaX;var y=_f3-this.deltaY;if(this.constrainX){if(x<this.minX){x=this.minX;}if(x>this.maxX){x=this.maxX;}}if(this.constrainY){if(y<this.minY){y=this.minY;}if(y>this.maxY){y=this.maxY;}}x=this.getTick(x,this.xTicks);y=this.getTick(y,this.yTicks);return {x:x,y:y};};YAHOO.util.DD.prototype.applyConfig=function(){YAHOO.util.DD.superclass.applyConfig.call(this);this.scroll=(this.config.scroll!==false);};YAHOO.util.DD.prototype.b4MouseDown=function(e){this.autoOffset(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));};YAHOO.util.DD.prototype.b4Drag=function(e){this.setDragElPos(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));};YAHOO.util.DD.prototype.toString=function(){return ("DD "+this.id);};YAHOO.util.DDProxy=function(id,_f9,_fa){if(id){this.init(id,_f9,_fa);this.initFrame();}};YAHOO.extend(YAHOO.util.DDProxy,YAHOO.util.DD);YAHOO.util.DDProxy.dragElId="ygddfdiv";YAHOO.util.DDProxy.prototype.resizeFrame=true;YAHOO.util.DDProxy.prototype.centerFrame=false;YAHOO.util.DDProxy.prototype.createFrame=function(){var _fb=this;var _fc=document.body;if(!_fc||!_fc.firstChild){setTimeout(function(){_fb.createFrame();},50);return;}var div=this.getDragEl();if(!div){div=document.createElement("div");div.id=this.dragElId;var s=div.style;s.position="absolute";s.visibility="hidden";s.cursor="move";s.border="2px solid #aaa";s.zIndex=999;_fc.insertBefore(div,_fc.firstChild);}};YAHOO.util.DDProxy.prototype.initFrame=function(){this.createFrame();};YAHOO.util.DDProxy.prototype.applyConfig=function(){this.logger.log("DDProxy applyConfig");YAHOO.util.DDProxy.superclass.applyConfig.call(this);this.resizeFrame=(this.config.resizeFrame!==false);this.centerFrame=(this.config.centerFrame);this.setDragElId(this.config.dragElId||YAHOO.util.DDProxy.dragElId);};YAHOO.util.DDProxy.prototype.showFrame=function(_ff,_100){var el=this.getEl();var _102=this.getDragEl();var s=_102.style;this._resizeProxy();if(this.centerFrame){this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.height,10)/2));}this.setDragElPos(_ff,_100);YAHOO.util.Dom.setStyle(_102,"visibility","visible");};YAHOO.util.DDProxy.prototype._resizeProxy=function(){if(this.resizeFrame){var DOM=YAHOO.util.Dom;var el=this.getEl();var _106=this.getDragEl();var bt=parseInt(DOM.getStyle(_106,"borderTopWidth"),10);var br=parseInt(DOM.getStyle(_106,"borderRightWidth"),10);var bb=parseInt(DOM.getStyle(_106,"borderBottomWidth"),10);var bl=parseInt(DOM.getStyle(_106,"borderLeftWidth"),10);if(isNaN(bt)){bt=0;}if(isNaN(br)){br=0;}if(isNaN(bb)){bb=0;}if(isNaN(bl)){bl=0;}this.logger.log("proxy size: "+bt+"  "+br+" "+bb+" "+bl);var _10b=Math.max(0,el.offsetWidth-br-bl);var _10c=Math.max(0,el.offsetHeight-bt-bb);this.logger.log("Resizing proxy element");DOM.setStyle(_106,"width",_10b+"px");DOM.setStyle(_106,"height",_10c+"px");}};YAHOO.util.DDProxy.prototype.b4MouseDown=function(e){var x=YAHOO.util.Event.getPageX(e);var y=YAHOO.util.Event.getPageY(e);this.autoOffset(x,y);this.setDragElPos(x,y);};YAHOO.util.DDProxy.prototype.b4StartDrag=function(x,y){this.logger.log("start drag show frame, x: "+x+", y: "+y);this.showFrame(x,y);};YAHOO.util.DDProxy.prototype.b4EndDrag=function(e){this.logger.log(this.id+" b4EndDrag");YAHOO.util.Dom.setStyle(this.getDragEl(),"visibility","hidden");};YAHOO.util.DDProxy.prototype.endDrag=function(e){var DOM=YAHOO.util.Dom;this.logger.log(this.id+" endDrag");var lel=this.getEl();var del=this.getDragEl();DOM.setStyle(del,"visibility","");DOM.setStyle(lel,"visibility","hidden");YAHOO.util.DDM.moveToEl(lel,del);DOM.setStyle(del,"visibility","hidden");DOM.setStyle(lel,"visibility","");};YAHOO.util.DDProxy.prototype.toString=function(){return ("DDProxy "+this.id);};YAHOO.util.DDTarget=function(id,_118,_119){if(id){this.initTarget(id,_118,_119);}};YAHOO.extend(YAHOO.util.DDTarget,YAHOO.util.DragDrop);YAHOO.util.DDTarget.prototype.toString=function(){return ("DDTarget "+this.id);};function dragdropIsOk(){};